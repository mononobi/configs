# PipeWire is an audio server which has better quality than PulseAudio
# which is the default on ubuntu and most other distros.

# to enable PipeWire and disable PulseAudio, execute these commands. note that
# you should not execute all commands with sudo, only some of them:

sudo add-apt-repository ppa:pipewire-debian/pipewire-upstream
sudo add-apt-repository ppa:pipewire-debian/wireplumber-upstream
sudo apt update
sudo apt install libfdk-aac2 libldacbt-{abr,enc}2 libopenaptx0
## sudo apt install gstreamer1.0-pipewire libpipewire-0.3-{0,dev,modules} libspa-0.2-{bluetooth,dev,jack,modules} pipewire{,-{audio-client-libraries,pulse,media-session,bin,locales,tests}}
sudo apt install gstreamer1.0-pipewire libpipewire-0.3-{0,dev,modules} libspa-0.2-{bluetooth,dev,jack,modules} pipewire{,-{audio-client-libraries,pulse,bin,locales,tests}}
sudo apt install pipewire-doc
## sudo apt-get install pipewire-media-session
sudo apt-get install wireplumber{,-doc} gir1.2-wp-0.4 libwireplumber-0.4-{0,dev}
sudo apt-get remove --purge blueman && sudo rm -f /var/lib/blueman/network.state
sudo apt-get install blueman-git

systemctl --user daemon-reload
systemctl --user --now disable pulseaudio.{socket,service}
systemctl --user mask pulseaudio
systemctl --user --now enable pipewire{,-pulse}.{socket,service}
## systemctl --user --now enable pipewire-media-session.service
systemctl --user --now enable wireplumber.service
sudo systemctl enable --now blueman-mechanism.service

# now execute this to check if PipeWire is enabled:

pactl info

# to disable PipeWire and revert to PulseAudio, execute these commands:

sudo apt remove pipewire pipewire-audio-client-libraries
## sudo apt remove gstreamer1.0-pipewire libpipewire-0.3-{0,dev,modules} libspa-0.2-{bluetooth,dev,jack,modules} pipewire{,-{audio-client-libraries,pulse,media-session,bin,locales,tests}}
sudo apt remove gstreamer1.0-pipewire libpipewire-0.3-{0,dev,modules} libspa-0.2-{bluetooth,dev,jack,modules} pipewire{,-{audio-client-libraries,pulse,bin,locales,tests}}
sudo apt remove pipewire-doc
sudo apt remove wireplumber{,-doc} gir1.2-wp-0.4 libwireplumber-0.4-{0,dev}
sudo apt-get remove --purge blueman && sudo rm -f /var/lib/blueman/network.state

systemctl --user daemon-reload
systemctl --user --now enable pulseaudio.service pulseaudio.socket

# now execute this to check if PulseAudio is enabled:

pactl info
